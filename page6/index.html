<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name='yandex-verification' content='4a3e9fdb2ed97f52' />

  <title>
    
      Главная &middot; MrDekk
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/mrdekk.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic&subset=latin,cyrillic-ext,latin-ext,cyrillic'>
  <link rel="stylesheet" href="/public/css/font-awesome.min.css" >

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <link rel="stylesheet" href="/public/css/tabs.css">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
	  <img class="profile" alt="my-profile" src="/media/images/brujo.jpg" width="120px">
      <h1>MrDekk</h1>
      <p class="description">Время - лучший учитель! Жаль, что оно убивает своих учеников...</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
        <a href="/"><i class="fa fa-home" ></i></a>
      </li>

      

      
      
        
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/about/">Кто здесь?</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
          
        
      
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/tags/">Метки</a>
            </li>
          
        
      
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/useful/">Полезное</a>
            </li>
          
        
      
        
      
        
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/awesome/">Awesome Stars</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    </ul>

	<p class="social-icons">
		<!-- <a href="/search"><i class="fa fa-search fa-2x"></i></a> -->
		<a href="https://github.com/mrdekk"><i class="fa fa-github fa-2x"></i></a>
		<a href="https://twitter.com/mrdekk"><i class="fa fa-twitter fa-2x"></i></a>
		<a href="/atom.xml"><i class="fa fa-rss fa-2x"></i></a>
	</p>

    <p>&copy; 2025. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/09/05/run-on-ios10-device-from-xcode7/">
        Как отлаживать приложение для iOS 10 в xCode 7.3.1
      </a>
    </h1>

    <i class="icon fa fa-calendar-o text-danger"></i><span class="post-date">05.09.2016</span>
	<i class="icon fa fa-tags text-success"></i><p class="entry-tags">
  	
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#ios" title="Pages tagged ios" rel="tag" class="text-success">ios</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#objc" title="Pages tagged objc" rel="tag" class="text-success">objc</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#swift" title="Pages tagged swift" rel="tag" class="text-success">swift</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#xcode" title="Pages tagged xcode" rel="tag" class="text-success">xcode</a>
        </div>
        
      
    </p>

    <p>Случилась такая задача - отладить приложение собираемое с iOS 9 SDK на телефоне с iOS 10. Для этого собирать его надо естественно в xCode 7, но xCode 7 не видит устройства с iOS 10. Проблема относительно просто решается вот такой вот магией:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo ln</span> <span class="nt">-s</span> /Applications/Xcode8beta4.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/10.0<span class="se">\ \(</span>14A5322e<span class="se">\)</span> /Applications/Xcode7.3.1.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/
</code></pre></div></div>

<p>После этого можно отлаживаться в обычном режиме.</p>

<p>Аналогичным образом можно подцепить к Xcode 8 девайс с iOS 7.1 например</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo ln</span> <span class="nt">-s</span> /Applications/Xcode7.3.1.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/7.1 /Applications/Xcode8GM.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport
</code></pre></div></div>

<p>Но это уже на ваш страх и риск - никто работоспособность такого хака не гарантирует</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/09/04/poor-mans-package-management/">
        Poor Man's package management
      </a>
    </h1>

    <i class="icon fa fa-calendar-o text-danger"></i><span class="post-date">04.09.2016</span>
	<i class="icon fa fa-tags text-success"></i><p class="entry-tags">
  	
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#ios" title="Pages tagged ios" rel="tag" class="text-success">ios</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#objc" title="Pages tagged objc" rel="tag" class="text-success">objc</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#swift" title="Pages tagged swift" rel="tag" class="text-success">swift</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#xcode" title="Pages tagged xcode" rel="tag" class="text-success">xcode</a>
        </div>
        
      
    </p>

    <p>Вы наверняка пользовались пакетными менеджерами а-ля CocoaPods и Carthage. Однако иногда возникают ситуации когда вы хотите подцепить себе в проект сторонний проект, но при этом по какой-то причине не хотите пользоваться этими менеджерами пакетов. В таких случаях может пригодиться техника, которую я ласково называю “Poor Man’s package management” (пакетный менеджер для бедных, уж простят меня оные).</p>

<p>Суть техники в следующем - зависимости мы цепляем непосредственно как часть нашего проекта с помощью git submodules. Да, техника работает для пользователей git (хотя лично я знаю как ее применить и для SVN, думается, что уж для популярных DCVS систем такую технику уж точно придумать можно).</p>

<p>Для того, чтобы репозиторий зависимости стал “подпапкой” вашего проекта достаточно сделать так</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git submodule add http://github.com/cooluser/coolproject ./deps/coolproject
</code></pre></div></div>

<p>и далее ручками через xcode добавляем нужные файлы к себе в проект. Не забываем закоммитить .gitmodules себе в проект, это нужно чтобы ваши коллеги могли себе собрать тоже и также.</p>

<p>Чтобы другой человек (ваш коллега, например) получил полный экземпляр вашей работы кроме обычных действий при работе с подмодулями ему надо сделать</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git submodule init
git submodule update
</code></pre></div></div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/08/10/objc-check-ios-version/">
        Проверяем версию iOS
      </a>
    </h1>

    <i class="icon fa fa-calendar-o text-danger"></i><span class="post-date">10.08.2016</span>
	<i class="icon fa fa-tags text-success"></i><p class="entry-tags">
  	
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#ios" title="Pages tagged ios" rel="tag" class="text-success">ios</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#objc" title="Pages tagged objc" rel="tag" class="text-success">objc</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#swift" title="Pages tagged swift" rel="tag" class="text-success">swift</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#recipe" title="Pages tagged recipe" rel="tag" class="text-success">recipe</a>
        </div>
        
      
    </p>

    <p>Как проверить версию iOS? Очень просто:</p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">NSString</span><span class="o">*</span> <span class="n">requiredVersion</span> <span class="o">=</span> <span class="s">@"9.3.1"</span><span class="p">;</span>
<span class="n">NSString</span><span class="o">*</span> <span class="n">currentSystemVersion</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIDevice</span> <span class="nf">currentDevice</span><span class="p">]</span> <span class="nf">systemVersion</span><span class="p">];</span>
<span class="k">if</span> <span class="p">([</span><span class="n">currSystemVersion</span> <span class="nf">compare</span><span class="p">:</span><span class="n">requiredVersion</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSNumericSearch</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NSOrderedAscending</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// code that is suitable for iOS &gt;= 9.3.1</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// code for versions older that 9.3.1</span>
<span class="p">}</span>
</code></pre></div></div>

<p>В Swift’е это сделать несколько проще:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="kd">#available(iOS 9.3.1, *)</span> <span class="p">{</span>
    <span class="c1">// code that is suitable for iOS &gt;= 9.3.1</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// code for versions older than 9.3.1</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Важное отступление. Наверняка возникает вопрос, почему нельзя сделать так:</p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">UIDevice</span><span class="p">.</span><span class="n">currentDevice</span><span class="p">.</span><span class="n">systemVersion</span><span class="p">.</span><span class="n">floatValue</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something for iOS greater or equal 9.3</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Отвечаю. Пункт первый - а что если вам надо &gt;= 9.3.1 именно с 1 обновления, а не для всей 9.3? Float сравнение уже не позволит написать такое условие, в то же время приведенный мной код строкового сравнения позволяет сделать это. Пункт второй, более важный - сравнение чисел с плавающей точкой. Пример, для вот такого кода</p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">NSString</span><span class="o">*</span> <span class="n">systemVersion</span> <span class="o">=</span> <span class="s">@"9.3.2"</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">sysVer</span> <span class="o">=</span> <span class="n">systemVersion</span><span class="p">.</span><span class="n">floatValue</span><span class="p">;</span>
</code></pre></div></div>

<p>в sysVer будет 9.30000019 и простое сравнение sysVer == 9.3 не сработает. В таком случае надо бы делать fabs(sysVer - 9.3) &lt;= 0.01 что уже как проигрывает по выразительности, так и ставит вопросы - а каков эпсилон версий операционки?</p>

<p>Со swift’ом в общем таких проблем нет.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/08/05/customize-bootstrap/">
        Собираем свою версию bootstrap'а с кастомизацией
      </a>
    </h1>

    <i class="icon fa fa-calendar-o text-danger"></i><span class="post-date">05.08.2016</span>
	<i class="icon fa fa-tags text-success"></i><p class="entry-tags">
  	
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#boostrap" title="Pages tagged boostrap" rel="tag" class="text-success">boostrap</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#less" title="Pages tagged less" rel="tag" class="text-success">less</a>
        </div>
        
      
    </p>

    <p>В этой статье опишу рецепт, как сделать свою кастомизацию базовых стилей фреймворка twitter bootstrap. Для начала нам понадобяться собственно исходники бутстрапа:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/twbs/bootstrap.git
</code></pre></div></div>

<p>И опционально переключаемся на нужный тэг:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout tags/v3.3.7
</code></pre></div></div>

<p>Далее нам потребуется LESS для сборки css файлов bootstrap’а</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>npm i less <span class="nt">-g</span>
</code></pre></div></div>

<p>теперь попытаемся собрать CSS:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lessc bootstrap/less/bootstrap.less <span class="o">&gt;</span> boostrap.css
</code></pre></div></div>

<p>Или минифицированную версию</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lessc <span class="nt">--compress</span> bootstrap/less/bootstrap.less <span class="o">&gt;</span> boostrap.css
</code></pre></div></div>

<p>Теперь для создания своей конфигурации boostrap вы можете править файл bootstrap.less или его зависимости. Однако здесь таится одна небольшая проблема. Мы выше забрали исходники через гит. При выходе очередной версии вы наверняка захотите обновиться. Но в этом вам будут мешать сделанные изменения, которые надо будет куда-то деть. Да, конечно можно форкнуть репозиторий, сделать свою ветку и потом просто rebase’иться. Однако есть вариант лучше. Наши измения мы просто вынесем в отдельную папку, и они просто будут ссылаться на исходники boostrap’а. В таком случае обновление будет сводиться просто к <code class="language-plaintext highlighter-rouge">git checkout tags/...</code> и изредка правкой вашей кастомизации.</p>

<p>Чтож, приступим.</p>

<ol>
  <li>
    <p>Создаем папку</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>customization
</code></pre></div>    </div>
  </li>
  <li>
    <p>Создаем свои файлы в которые будем помещать кастомизацию</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp </span>bootstrap/less/variables.less customization/custom-variables.less
<span class="nb">echo</span> <span class="s2">""</span> <span class="o">&gt;</span> customization/custom-other.less
</code></pre></div>    </div>
  </li>
  <li>
    <p>Далее создаем наш кастомизированный центральный файл customization/custom-boostrap.less со следующим содержимым:</p>

    <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@import</span> <span class="s1">"../bootstrap/less/bootstrap.less"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s1">"custom-variables.less"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s1">"custom-other.less"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s1">"../bootstrap/less/utilities.less"</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Сделаем пробную сборку кастомизированного (на самом деле пока еще нет) bootstrap’а</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lessc customization/custom-bootstrap.less <span class="o">&gt;</span> bootstrap.css
</code></pre></div>    </div>
  </li>
</ol>

<p>После этого можно править custom-variables.less, перегенрировать и радоваться. Однако надо где-то смотреть. Есть вот такой хороший проект где все компоненты на одной странице https://github.com/mrdekk/bootstrap-tldr</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/mrdekk/bootstrap-tldr
npm <span class="nb">install
sudo </span>npm i bower <span class="nt">-g</span>
bower <span class="nb">install
sudo </span>npm i grunt <span class="nt">-g</span>
lessc customization/custom-bootstrap.less bootstrap-tldr/app/styles/bootstrap.css
grunt serve
</code></pre></div></div>

<p>После этого http://localhost:9000 вы сможете лицезреть страничку со всеми элементами bootstrap</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/08/01/stop-doing-mappers/">
        Крик души о мапперах API в модель
      </a>
    </h1>

    <i class="icon fa fa-calendar-o text-danger"></i><span class="post-date">01.08.2016</span>
	<i class="icon fa fa-tags text-success"></i><p class="entry-tags">
  	
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#xcode" title="Pages tagged xcode" rel="tag" class="text-success">xcode</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#ios" title="Pages tagged ios" rel="tag" class="text-success">ios</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#objc" title="Pages tagged objc" rel="tag" class="text-success">objc</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#swift" title="Pages tagged swift" rel="tag" class="text-success">swift</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#api" title="Pages tagged api" rel="tag" class="text-success">api</a>
        </div>
        &nbsp;
      
  	  <div class="label bg-success">
  	    <a href="http://mrdekk.ru/tags/#architecture" title="Pages tagged architecture" rel="tag" class="text-success">architecture</a>
        </div>
        
      
    </p>

    <p>В последнее время очень часто приходится сталкиваться вот с каким вопросом. Мобильные приложения должны работать с бэкендом. Как правило, модель данных API бэкенда не совсем сходится с моделью данных на самом приложении, и даже если сходится 1 в 1, библиотеки сетевых запросов возвращают объекты класса словарь (как бы он не назывался - Map&lt;?, ?&gt;, NSDictionary, …) и возникает необходимость конвертации вида</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">json</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">SomethingModel</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">model</span> <span class="o">=</span> <span class="kt">SomethingModel</span><span class="p">()</span>    
    <span class="n">model</span><span class="o">.</span><span class="kd">some</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"some"</span><span class="p">]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">another</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"another"</span><span class="p">]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"rest"</span><span class="p">]</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">model</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">reverse</span><span class="p">(</span><span class="nv">obj</span><span class="p">:</span> <span class="kt">SomethingModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">res</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]()</span>
    <span class="n">json</span><span class="p">[</span><span class="s">"some"</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="kd">some</span>
    <span class="n">json</span><span class="p">[</span><span class="s">"another"</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">another</span>
    <span class="n">json</span><span class="p">[</span><span class="s">"rest"</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">rest</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">model</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Как видно, это большей частью простые императивные преобразования. Иногда конечно возникает необходимость дополнительной проверки (например на nil) или кастомной конвертации (NSDate -&gt; String). Однако для этого можно написать простые хелперы и код будет выглядить как-нибудь так:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="o">.</span><span class="n">nillable</span> <span class="o">=</span> <span class="kt">Conv</span><span class="o">.</span><span class="nf">nillable</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="s">"nillable"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="kt">Conv</span><span class="o">.</span><span class="nf">date</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="s">"date"</span><span class="p">)</span>
</code></pre></div></div>

<p>Что же есть на практике. А на практике каждый уважающий себя разработчик стремится для <code class="language-plaintext highlighter-rouge">model.some = json["some"]</code> написать кастомную обертку, и что особенно важно, декларативно. То есть вместо упомянутой строчки мы получаем нечто вроде:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">class</span> <span class="kt">SomethingModel</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">jsonMap</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">res</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]()</span>
        <span class="n">res</span><span class="p">[</span><span class="s">"some"</span><span class="p">]</span> <span class="o">=</span> <span class="kt">StringMapping</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="s">"some"</span><span class="p">)</span>
        <span class="n">res</span><span class="p">[</span><span class="s">"another"</span><span class="p">]</span> <span class="o">=</span> <span class="kt">NumberMapping</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="s">"another"</span><span class="p">,</span> <span class="k">default</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">res</span><span class="p">[</span><span class="s">"rest"</span><span class="p">]</span> <span class="o">=</span> <span class="kt">DateMapping</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="s">"rest"</span><span class="p">,</span> <span class="kt">NSDate</span><span class="p">())</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">DeclarativeMapper</span><span class="o">&lt;</span><span class="kt">ModelClass</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">fromJson</span><span class="p">(</span><span class="nv">json</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">ModelClass</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">model</span> <span class="o">=</span> <span class="kt">ModelClass</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">mapping</span> <span class="o">=</span> <span class="kt">ModelClass</span><span class="o">.</span><span class="nf">jsonMap</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">mapper</span><span class="p">)</span> <span class="k">in</span> <span class="n">mapping</span><span class="o">.</span><span class="nf">enumerate</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">model</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="nv">field</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span> <span class="n">mapper</span><span class="o">.</span><span class="nf">map</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">mapper</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">model</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">json</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">declarativeMapper</span> <span class="o">=</span> <span class="kt">DeclarativeMapper</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">model</span> <span class="o">=</span> <span class="n">declarativeMapper</span><span class="o">.</span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
</code></pre></div></div>

<p>У меня есть главный вопрос - а зачем все это делается? Ради декларативности - императивный код проще  и сосредоточен в одном месте - в коде запроса, в точке наиболее близкой к точке изменения контракта. Декларативный код размазывает маппинги по нескольким местам и вносит дополнительный код (мапперы), которые могут сломаться. Кроме того, декларативный фреймворки делают некоторые предположения относительно того, как работает бэкенд и если вдруг бэкенд работает не совсем так - у фреймворка возникают проблемы.</p>

<p>Может ли кто-нибудь привести примеры, в которой вся эта декларактивная машинерия оправдана?</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page7"><i class="fa fa-hand-o-left" ></i> назад</a>
  
  
    
      <a class="pagination-item newer" href="/page5">вперед <i class="fa fa-hand-o-right" ></i></a>
    
  
</div>

    </div>

	<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter13259782 = new Ya.Metrika({
                    id:13259782,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/13259782" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-16734363-2', 'auto');
  ga('send', 'pageview');

</script>

    <script src="/public/js/tabs.js"></script>

  </body>
</html>
